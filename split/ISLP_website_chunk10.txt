 $50,000 on radio advertising is associated with higher sales than allocating $100,000
to either television or radio individually. In marketing, this is known
as a synergy effect, while in statistics it is called an interaction effect. synergy
It turns out that linear regression can be used to answer each of these interaction
questions. We will first discuss all of these questions in a general context,
and then return to them in this specific context in Section 3.4.

3.1

Simple Linear Regression

Simple linear regression lives up to its name: it is a very straightforward
simple linear
approach for predicting a quantitative response Y on the basis of a sin- regression
gle predictor variable X. It assumes that there is approximately a linear
relationship between X and Y . Mathematically, we can write this linear
relationship as
Y ≈ β0 + β1 X.
(3.1)
You might read “≈” as “is approximately modeled as”. We will sometimes
describe (3.1) by saying that we are regressing Y on X (or Y onto X).

3.1 Simple Linear Regression

71

For example, X may represent TV advertising and Y may represent sales.
Then we can regress sales onto TV by fitting the model
sales ≈ β0 + β1 × TV.

In Equation 3.1, β0 and β1 are two unknown constants that represent
the intercept and slope terms in the linear model. Together, β0 and β1 are
intercept
known as the model coefficients or parameters. Once we have used our
slope
training data to produce estimates β̂0 and β̂1 for the model coefficients, we
coefficient
can predict future sales on the basis of a particular value of TV advertising parameter
by computing
ŷ = β̂0 + β̂1 x,
(3.2)
where ŷ indicates a prediction of Y on the basis of X = x. Here we use a
hat symbol, ˆ , to denote the estimated value for an unknown parameter
or coefficient, or to denote the predicted value of the response.

3.1.1

Estimating the Coefficients

In practice, β0 and β1 are unknown. So before we can use (3.1) to make
predictions, we must use data to estimate the coefficients. Let
(x1 , y1 ), (x2 , y2 ), . . . , (xn , yn )
represent n observation pairs, each of which consists of a measurement of
X and a measurement of Y . In the Advertising example, this data set consists of the TV advertising budget and product sales in n = 200 different
markets. (Recall that the data are displayed in Figure 2.1.) Our goal is to
obtain coefficient estimates β̂0 and β̂1 such that the linear model (3.1) fits
the available data well—that is, so that yi ≈ β̂0 + β̂1 xi for i = 1, . . . , n. In
other words, we want to find an intercept β̂0 and a slope β̂1 such that the
resulting line is as close as possible to the n = 200 data points. There are
a number of ways of measuring closeness. However, by far the most common approach involves minimizing the least squares criterion, and we take
least squares
that approach in this chapter. Alternative approaches will be considered in
Chapter 6.
Let ŷi = β̂0 + β̂1 xi be the prediction for Y based on the ith value of X.
Then ei = yi − ŷi represents the ith residual—this is the difference between
residual
the ith observed response value and the ith response value that is predicted
by our linear model. We define the residual sum of squares (RSS) as
or equivalently as

RSS = e21 + e22 + · · · + e2n ,

RSS = (y1 − β̂0 − β̂1 x1 )2 + (y2 − β̂0 − β̂1 x2 )2 + · · · + (yn − β̂0 − β̂1 xn )2 . (3.3)

The least squares approach chooses β̂0 and β̂1 to minimize the RSS. Using
some calculus, one can show that the minimizers are
)n
(x − x̄)(yi − ȳ)
)n i
β̂1 = i=1
,
2
(3.4)
i=1 (xi − x̄)
β̂0 = ȳ − β̂1 x̄,

residual sum
of squares

3. Linear Regression

15
5

10

Sales

20

25

72

0

50

100

150

200

250

300

TV

FIGURE 3.1. For the Advertising data, the least squares fit for the regression
of sales onto TV is shown. The fit is found by minimizing the residual sum of
squares. Each grey line segment represents a residual. In this case a linear fit
captures the essence of the relationship, although it overestimates the trend in the
left of the plot.

)n
)n
where ȳ ≡ n1 i=1 yi and x̄ ≡ n1 i=1 xi are the sample means. In other
words, (3.4) defines the least squares coefficient estimates for simple linear
regression.
Figure 3.1 displays the simple linear regression fit to the Advertising
data, where β̂0 = 7.03 and β̂1 = 0.0475. In other words, according to
this approximation, an additional $1,000 spent on TV advertising is associated with selling approximately 47.5 additional units of the product. In
Figure 3.2, we have computed RSS for a number of values of β0 and β1 ,
using the advertising data with sales as the response and TV as the predictor. In each plot, the red dot represents the pair of least squares estimates
(β̂0 , β̂1 ) given by (3.4). These values clearly minimize the RSS.

3.1.2

Assessing the Accuracy of the Coefficient Estimates

Recall from (2.1) that we assume that the true relationship between X and
Y takes the form Y = f (X) + " for some unknown function f , where "
is a mean-zero random error term. If f is to be approximated by a linear
function, then we can write this relationship as
Y = β0 + β1 X + ".

(3.5)

Here β0 is the intercept term—that is, the expected value of Y when X = 0,
and β1 is the slope—the average increase in Y associated with a one-unit
increase in X. The error term is a catch-all for what we miss with this
simple model: the true relationship is probably not linear, there may be
other variables that cause variation in Y , and there may be measurement
error. We typically assume that the error term is independent of X.

3.1 Simple Linear Regression

73

3
0.06

2.5

0.05

RSS

2.11

0.04

β1

2.15

2.2

2.3
0.03

2.5
3
5

6

7

8

9

β0

β1

β0

FIGURE 3.2. Contour and three-dimensional plots of the RSS on the
Advertising data, using sales as the response and TV as the predictor. The
red dots correspond to the least squares estimates β̂0 and β̂1 , given by (3.4).

The model given by (3.5) defines the population regression line, which
population
is the best linear approximation to the true relationship between X and regression
Y .1 The least squares regression coefficient estimates (3.4) characterize the line
least squares line (3.2). The left-hand panel of Figure 3.3 displays these
least squares
two lines in a simple simulated example. We created 100 random Xs, and line
generated 100 corresponding Y s from the model
Y = 2 + 3X + ",

(3.6)

where " was generated from a normal distribution with mean zero. The
red line in the left-hand panel of Figure 3.3 displays the true relationship,
f (X) = 2 + 3X, while the blue line is the least squares estimate based
on the observed data. The true relationship is generally not known for
real data, but the least squares line can always be computed using the
coefficient estimates given in (3.4). In other words, in real applications,
we have access to a set of observations from which we can compute the
least squares line; however, the population regression line is unobserved.
In the right-hand panel of Figure 3.3 we have generated ten different data
sets from the model given by (3.6) and plotted the corresponding ten least
squares lines. Notice that different data sets generated from the same true
model result in slightly different least squares lines, but the unobserved
population regression line does not change.
At first glance, the difference between the population regression line and
the least squares line may seem subtle and confusing. We only have one
data set, and so what does it mean that two different lines describe the
relationship between the predictor and the response? Fundamentally, the
concept of these two lines is a natural extension of the standard statistical
approach of using information from a sample to estimate characteristics of a
large population. For example, suppose that we are interested in knowing
1 The assumption of linearity is often a useful working model. However, despite what
many textbooks might tell us, we seldom believe that the true relationship is linear.

5
−10

−5

0

Y
−10

−5

0

Y

5

10

3. Linear Regression

10

74

−2

−1

0
X

1

2

−2

−1

0

1

2

X

FIGURE 3.3. A simulated data set. Left: The red line represents the true
relationship, f (X) = 2 + 3X, which is known as the population regression line.
The blue line is the least squares line; it is the least squares estimate for f (X)
based on the observed data, shown in black. Right: The population regression line
is again shown in red, and the least squares line in dark blue. In light blue, ten
least squares lines are shown, each computed on the basis of a separate random
set of observations. Each least squares line is different, but on average, the least
squares lines are quite close to the population regression line.

the population mean µ of some random variable Y . Unfortunately, µ is
unknown, but we do have access to n observations from Y , y1 , . . . , yn ,
which )
we can use to estimate µ. A reasonable estimate is µ̂ = ȳ, where
n
ȳ = n1 i=1 yi is the sample mean. The sample mean and the population
mean are different, but in general the sample mean will provide a good
estimate of the population mean. In the same way, the unknown coefficients
β0 and β1 in linear regression define the population regression line. We seek
to estimate these unknown coefficients using β̂0 and β̂1 given in (3.4). These
coefficient estimates define the least squares line.
The analogy between linear regression and estimation of the mean of a
random variable is an apt one based on the concept of bias. If we use the
bias
sample mean µ̂ to estimate µ, this estimate is unbiased, in the sense that
unbiased
on average, we expect µ̂ to equal µ. What exactly does this mean? It means
that on the basis of one particular set of observations y1 , . . . , yn , µ̂ might
overestimate µ, and on the basis of another set of observations, µ̂ might
underestimate µ. But if we could average a huge number of estimates of
µ obtained from a huge number of sets of observations, then this average
would exactly equal µ. Hence, an unbiased estimator does not systematically
over- or under-estimate the true parameter. The property of unbiasedness
holds for the least squares coefficient estimates given by (3.4) as well: if
we estimate β0 and β1 on the basis of a particular data set, then our
estimates won’t be exactly equal to β0 and β1 . But if we could average
the estimates obtained over a huge number of data sets, then the average
of these estimates would be spot on! In fact, we can see from the righthand panel of Figure 3.3 that the average of many least squares lines, each

3.1 Simple Linear Regression

75

estimated from a separate data set, is pretty close to the true population
regression line.
We continue the analogy with the estimation of the population mean
µ of a random variable Y . A natural question is as follows: how accurate
is the sample mean µ̂ as an estimate of µ? We have established that the
average of µ̂’s over many data sets will be very close to µ, but that a
single estimate µ̂ may be a substantial underestimate or overestimate of µ.
How far off will that single estimate of µ̂ be? In general, we answer this
question by computing the standard error of µ̂, written as SE(µ̂). We have
standard
the well-known formula
error
Var(µ̂) = SE(µ̂) =
2

σ2
,
n

(3.7)

where σ is the standard deviation of each of the realizations yi of Y .2
Roughly speaking, the standard error tells us the average amount that this
estimate µ̂ differs from the actual value of µ. Equation 3.7 also tells us how
this deviation shrinks with n—the more observations we have, the smaller
the standard error of µ̂. In a similar vein, we can wonder how close β̂0
and β̂1 are to the true values β0 and β1 . To compute the standard errors
associated with β̂0 and β̂1 , we use the following formulas:
3
4
2
2
1
x̄2
σ2
SE(β̂0 ) = σ 2
+ )n
, SE(β̂1 ) = )n
, (3.8)
2
2
n
i=1 (xi − x̄)
i=1 (xi − x̄)

where σ 2 = Var("). For these formulas to be strictly valid, we need to
assume that the errors "i for each observation have common variance σ 2 and
are uncorrelated. This is clearly not true in Figure 3.1, but the formula still
turns out to be a good approximation. Notice in the formula that SE(β̂1 ) is
smaller when the xi are more spread out; intuitively we have more leverage
to estimate a slope when this is the case. We also see that SE(β̂0 ) would be
the same as SE(µ̂) if x̄ were zero (in which case β̂0 would be equal to ȳ). In
general, σ 2 is not known, but can be estimated from the data. This estimate
of σ is known
as the residual standard error, and is given by the formula
5
residual
RSE = RSS/(n − 2). Strictly speaking, when σ 2 is estimated from the standard
6 β̂1 ) to indicate that an estimate has been made, error
data we should write SE(
but for simplicity of notation we will drop this extra “hat”.
Standard errors can be used to compute confidence intervals. A 95 %
confidence
confidence interval is defined as a range of values such that with 95 % interval
probability, the range will contain the true unknown value of the parameter. The range is defined in terms of lower and upper limits computed
from the sample of data. A 95% confidence interval has the following property: if we take repeated samples and construct the confidence interval for
each sample, 95% of the intervals will contain the true unknown value of
the parameter. For linear regression, the 95 % confidence interval for β1
approximately takes the form
β̂1 ± 2 · SE(β̂1 ).
2 This formula holds provided that the n observations are uncorrelated.

(3.9)

76

3. Linear Regression

That is, there is approximately a 95 % chance that the interval
7
8
β̂1 − 2 · SE(β̂1 ), β̂1 + 2 · SE(β̂1 )

(3.10)

will contain the true value of β1 .3 Similarly, a confidence interval for β0
approximately takes the form
β̂0 ± 2 · SE(β̂0 ).

(3.11)

In the case of the advertising data, the 95 % confidence interval for β0
is [6.130, 7.935] and the 95 % confidence interval for β1 is [0.042, 0.053].
Therefore, we can conclude that in the absence of any advertising, sales will,
on average, fall somewhere between 6,130 and 7,935 units. Furthermore,
for each $1,000 increase in television advertising, there will be an average
increase in sales of between 42 and 53 units.
Standard errors can also be used to perform hypothesis tests on the
hypothesis
coefficients. The most common hypothesis test involves testing the null test
hypothesis of
H0 : There is no relationship between X and Y

(3.12)

versus the alternative hypothesis
Ha : There is some relationship between X and Y .

(3.13)

null
hypothesis

alternative
hypothesis

Mathematically, this corresponds to testing
H0 : β 1 = 0
versus
Ha : β1 %= 0,

since if β1 = 0 then the model (3.5) reduces to Y = β0 + ", and X is
not associated with Y . To test the null hypothesis, we need to determine
whether β̂1 , our estimate for β1 , is sufficiently far from zero that we can
be confident that β1 is non-zero. How far is far enough? This of course
depends on the accuracy of β̂1 —that is, it depends on SE(β̂1 ). If SE(β̂1 ) is
small, then even relatively small values of β̂1 may provide strong evidence
that β1 %= 0, and hence that there is a relationship between X and Y . In
contrast, if SE(β̂1 ) is large, then β̂1 must be large in absolute value in order
for us to reject the null hypothesis. In practice, we compute a t-statistic,
t-statistic
given by
β̂1 − 0
t=
,
(3.14)
SE(β̂1 )
3 Approximately for several reasons. Equation 3.10 relies on the as