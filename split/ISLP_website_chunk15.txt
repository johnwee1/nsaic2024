 the linear regression model is not our primary focus here, we
will provide only a brief summary of some key points.
1. Non-linearity of the Data
Residual Plot for Quadratic Fit

323
330

323

5
−5

0

Residuals

10
5
0
−15 −10

−15 −10

−5

Residuals

334

10

334

15

15

20

Residual Plot for Linear Fit

5

10

15

20

Fitted values

25

30

155

15

20

25

30

35

Fitted values

FIGURE 3.9. Plots of residuals versus predicted (or fitted) values for the Auto
data set. In each plot, the red line is a smooth fit to the residuals, intended to make
it easier to identify a trend. Left: A linear regression of mpg on horsepower. A
strong pattern in the residuals indicates non-linearity in the data. Right: A linear
regression of mpg on horsepower and horsepower2 . There is little pattern in the
residuals.

The linear regression model assumes that there is a straight-line relationship between the predictors and the response. If the true relationship
is far from linear, then virtually all of the conclusions that we draw from
the fit are suspect. In addition, the prediction accuracy of the model can
be significantly reduced.
Residual plots are a useful graphical tool for identifying non-linearity.
residual plot
Given a simple linear regression model, we can plot the residuals, ei =

3.3 Other Considerations in the Regression Model

101

yi − ŷi , versus the predictor xi . In the case of a multiple regression model,
since there are multiple predictors, we instead plot the residuals versus
the predicted (or fitted) values ŷi . Ideally, the residual plot will show no
fitted
discernible pattern. The presence of a pattern may indicate a problem with
some aspect of the linear model.
The left panel of Figure 3.9 displays a residual plot from the linear regression of mpg onto horsepower on the Auto data set that was illustrated in
Figure 3.8. The red line is a smooth fit to the residuals, which is displayed in
order to make it easier to identify any trends. The residuals exhibit a clear
U-shape, which provides a strong indication of non-linearity in the data.
In contrast, the right-hand panel of Figure 3.9 displays the residual plot
that results from the model (3.36), which contains a quadratic term. There
appears to be little pattern in the residuals, suggesting that the quadratic
term improves the fit to the data.
If the residual plot indicates that there are non-linear associations in the
data, then a simple approach
√ is to use non-linear transformations of the
predictors, such as log X, X, and X 2 , in the regression model. In the
later chapters of this book, we will discuss other more advanced non-linear
approaches for addressing this issue.
2. Correlation of Error Terms
An important assumption of the linear regression model is that the error
terms, "1 , "2 , . . . , "n , are uncorrelated. What does this mean? For instance,
if the errors are uncorrelated, then the fact that "i is positive provides
little or no information about the sign of "i+1 . The standard errors that
are computed for the estimated regression coefficients or the fitted values
are based on the assumption of uncorrelated error terms. If in fact there is
correlation among the error terms, then the estimated standard errors will
tend to underestimate the true standard errors. As a result, confidence and
prediction intervals will be narrower than they should be. For example,
a 95 % confidence interval may in reality have a much lower probability
than 0.95 of containing the true value of the parameter. In addition, pvalues associated with the model will be lower than they should be; this
could cause us to erroneously conclude that a parameter is statistically
significant. In short, if the error terms are correlated, we may have an
unwarranted sense of confidence in our model.
As an extreme example, suppose we accidentally doubled our data, leading to observations and error terms identical in pairs. If we ignored this, our
standard error calculations would be as if we had a sample of size 2n, when
in fact we have only n samples. Our estimated parameters would be the
same for the 2n samples as for the√n samples, but the confidence intervals
would be narrower by a factor of 2!
Why might correlations among the error terms occur? Such correlations
frequently occur in the context of time series data, which consists of obtime series
servations for which measurements are obtained at discrete points in time.
In many cases, observations that are obtained at adjacent time points will
have positively correlated errors. In order to determine if this is the case for
a given data set, we can plot the residuals from our model as a function of
time. If the errors are uncorrelated, then there should be no discernible pat-

102

3. Linear Regression

1
−1 0
−3

Residual

2

3

ρ=0.0

0

20

40

60

80

100

60

80

100

60

80

100

0
−4

−2

Residual

1

2

ρ=0.5

0

20

40

0.5
−0.5
−1.5

Residual

1.5

ρ=0.9

0

20

40

Observation

FIGURE 3.10. Plots of residuals from simulated time series data sets generated
with differing levels of correlation ρ between error terms for adjacent time points.

tern. On the other hand, if the error terms are positively correlated, then
we may see tracking in the residuals—that is, adjacent residuals may have
tracking
similar values. Figure 3.10 provides an illustration. In the top panel, we see
the residuals from a linear regression fit to data generated with uncorrelated errors. There is no evidence of a time-related trend in the residuals.
In contrast, the residuals in the bottom panel are from a data set in which
adjacent errors had a correlation of 0.9. Now there is a clear pattern in the
residuals—adjacent residuals tend to take on similar values. Finally, the
center panel illustrates a more moderate case in which the residuals had a
correlation of 0.5. There is still evidence of tracking, but the pattern is less
clear.
Many methods have been developed to properly take account of correlations in the error terms in time series data. Correlation among the error
terms can also occur outside of time series data. For instance, consider a
study in which individuals’ heights are predicted from their weights. The
assumption of uncorrelated errors could be violated if some of the individuals in the study are members of the same family, eat the same diet,
or have been exposed to the same environmental factors. In general, the
assumption of uncorrelated errors is extremely important for linear regression as well as for other statistical methods, and good experimental design
is crucial in order to mitigate the risk of such correlations.

3.3 Other Considerations in the Regression Model

0.4

Response log(Y)

15

Response Y

−10
10

15

20

25

30

Fitted values

0.0
−0.8 −0.6 −0.4 −0.2

0

Residuals

5

0.2

10

998
975
845

−5

Residuals

103

605

437

2.4

2.6

2.8

671

3.0

3.2

3.4

Fitted values

FIGURE 3.11. Residual plots. In each plot, the red line is a smooth fit to the
residuals, intended to make it easier to identify a trend. The blue lines track the
outer quantiles of the residuals, and emphasize patterns. Left: The funnel shape
indicates heteroscedasticity. Right: The response has been log transformed, and
there is now no evidence of heteroscedasticity.

3. Non-constant Variance of Error Terms
Another important assumption of the linear regression model is that the
error terms have a constant variance, Var("i ) = σ 2 . The standard errors,
confidence intervals, and hypothesis tests associated with the linear model
rely upon this assumption.
Unfortunately, it is often the case that the variances of the error terms are
non-constant. For instance, the variances of the error terms may increase
with the value of the response. One can identify non-constant variances in
the errors, or heteroscedasticity, from the presence of a funnel shape in
heterothe residual plot. An example is shown in the left-hand panel of Figure 3.11, scedasticity
in which the magnitude of the residuals tends to increase with the fitted
values. When faced with this problem, one possible solution is√to transform the response Y using a concave function such as log Y or Y . Such
a transformation results in a greater amount of shrinkage of the larger responses, leading to a reduction in heteroscedasticity. The right-hand panel
of Figure 3.11 displays the residual plot after transforming the response
using log Y . The residuals now appear to have constant variance, though
there is some evidence of a slight non-linear relationship in the data.
Sometimes we have a good idea of the variance of each response. For
example, the ith response could be an average of ni raw observations. If
each of these raw observations is uncorrelated with variance σ 2 , then their
average has variance σi2 = σ 2 /ni . In this case a simple remedy is to fit our
model by weighted least squares, with weights proportional to the inverse
weighted
variances—i.e. wi = ni in this case. Most linear regression software allows least squares
for observation weights.
4. Outliers
An outlier is a point for which yi is far from the value predicted by the

outlier

3. Linear Regression
20

4
2
0

Studentized Residuals

3
2

−4

−1

−2

0

1

Residuals

4
2
0

Y

20

4

6

20

6

104

−2

−1

0

1

2

X

−2

0

2

4

Fitted Values

6

−2

0

2

4

6

Fitted Values

FIGURE 3.12. Left: The least squares regression line is shown in red, and the
regression line after removing the outlier is shown in blue. Center: The residual
plot clearly identifies the outlier. Right: The outlier has a studentized residual of
6; typically we expect values between −3 and 3.

model. Outliers can arise for a variety of reasons, such as incorrect recording
of an observation during data collection.
The red point (observation 20) in the left-hand panel of Figure 3.12
illustrates a typical outlier. The red solid line is the least squares regression
fit, while the blue dashed line is the least squares fit after removal of the
outlier. In this case, removing the outlier has little effect on the least squares
line: it leads to almost no change in the slope, and a miniscule reduction
in the intercept. It is typical for an outlier that does not have an unusual
predictor value to have little effect on the least squares fit. However, even
if an outlier does not have much effect on the least squares fit, it can cause
other problems. For instance, in this example, the RSE is 1.09 when the
outlier is included in the regression, but it is only 0.77 when the outlier
is removed. Since the RSE is used to compute all confidence intervals and
p-values, such a dramatic increase caused by a single data point can have
implications for the interpretation of the fit. Similarly, inclusion of the
outlier causes the R2 to decline from 0.892 to 0.805.
Residual plots can be used to identify outliers. In this example, the outlier is clearly visible in the residual plot illustrated in the center panel of
Figure 3.12. But in practice, it can be difficult to decide how large a residual needs to be before we consider the point to be an outlier. To address
this problem, instead of plotting the residuals, we can plot the studentized
residuals, computed by dividing each residual ei by its estimated standard
studentized
error. Observations whose studentized residuals are greater than 3 in abso- residual
lute value are possible outliers. In the right-hand panel of Figure 3.12, the
outlier’s studentized residual exceeds 6, while all other observations have
studentized residuals between −2 and 2.
If we believe that an outlier has occurred due to an error in data collection or recording, then one solution is to simply remove the observation.
However, care should be taken, since an outlier may instead indicate a
deficiency with the model, such as a missing predictor.
5. High Leverage Points
We just saw that outliers are observations for which the response yi is
unusual given the predictor xi . In contrast, observations with high leverage
high
have an unusual value for xi . For example, observation 41 in the left-hand leverage

−1

0

1

2

3

4

−2

−1

0

1

2

X1

X

4
2

3

41

−1

−2
−2

20

1

0

X2

0

−1

5

Y

20

105

0

Studentized Residuals

1

10

2

41

5

3.3 Other Considerations in the Regression Model

0.00 0.05 0.10 0.15 0.20 0.25
Leverage

FIGURE 3.13. Left: Observation 41 is a high leverage point, while 20 is not.
The red line is the fit to all the data, and the blue line is the fit with observation
41 removed. Center: The red observation is not unusual in terms of its X1 value
or its X2 value, but still falls outside the bulk of the data, and hence has high
leverage. Right: Observation 41 has a high leverage and a high residual.

panel of Figure 3.13 has high leverage, in that the predictor value for this
observation is large relative to the other observations. (Note that the data
displayed in Figure 3.13 are the same as the data displayed in Figure 3.12,
but with the addition of a single high leverage observation.) The red solid
line is the least squares fit to the data, while the blue dashed line is the
fit produced when observation 41 is removed. Comparing the left-hand
panels of Figures 3.12 and 3.13, we observe that removing the high leverage
observation has a much more substantial impact on the least squares line
than removing the outlier. In fact, high leverage observations tend to have
a sizable impact on the estimated regression line. It is cause for concern if
the least squares line is heavily affected by just a couple of observations,
because any problems with these points may invalidate the entire fit. For
this reason, it is important to identify high leverage observations.
In a simple linear regression, high leverage observations are fairly easy to
identify, since we can simply look for observations for which the predictor
value is outside of the normal range of the observations. But in a multiple
linear regression with many predictors, it is possible to have an observation
that is well within the range of each individual predictor’s values, but that
is unusual in terms of the full set of predictors. An example is shown in
the center panel of Figure 3.13, for a data set with two predictors, X1 and
X2 . Most of the observations’ predictor values fall within the blue dashed
ellipse, but the red observation is well outside of this range. But neither its
value for X1 nor its value for X2 is unusual. So if we examine just X1 or
just X2 , we will fail to notice this high leverage point. This problem is more
pronounced in multiple regression settings with more than two predictors,
because then there is no simple way to plot all dimensions of the data
simultaneously.
In order to quantify an observation’s leverage, we compute the leverage
statistic. A large value of this statistic indicates an observation with high
leverage
leverage. For a simple linear regression,
statistic
hi =

1
(xi − x̄)2
+ )n
.
2
n
i! =1 (xi! − x̄)

(3.37)

3. Linear Regression

30

200

40

400

600

Rating

60
50

Age

70

800

80

106

2000 4000 6000 8000
Limit

12000

2000 4000 6000 8000

12000

Limit

FIGURE 3.14. Scatterplots of the observations from the Credit data set. Left:
A plot of age versus limit. These two variables are not collinear. Right: A plot
of rating versus limit. There is high collinearity.

It is clear from this equation that hi increases with the distance of xi from x̄.
There is a simple extension of hi to the case of multiple predictors, though
w